<!DOCTYPE html>
<html lang="nl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stad, Land, Rivier</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css?v=30">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
</head>

<body>
    <div class="background-blobs">
        <div class="blob blob-1"></div>
        <div class="blob blob-2"></div>
        <div class="blob blob-3"></div>
    </div>

    <main class="app-container">
        <header class="game-header">
            <h1>Stad <span class="highlight">Land</span> Rivier <small
                    style="font-size: 0.4em; opacity: 0.6; font-weight: 300; display: block; margin-top: -5px;">by
                    JW</small></h1>
            <div class="header-controls">
                <button id="theme-toggle" class="icon-btn" aria-label="Toggle Theme"><i
                        class="fa-solid fa-moon"></i></button>
            </div>
        </header>

        <!-- Lobby Screen -->
        <section id="lobby-screen" class="glass-panel lobby-panel">
            <h2>Welkom!</h2>
            <div class="input-group">
                <label for="player-name">Jouw Naam</label>
                <input type="text" id="player-name" placeholder="Typ je naam...">
            </div>

            <div class="input-group">
                <label for="room-name-input">Kamer Naam (optioneel)</label>
                <input type="text" id="room-name-input" placeholder="Bijv. Vrienden Groep...">
            </div>

            <div class="lobby-actions">
                <button id="create-room-btn" class="primary-btn">Nieuwe Kamer</button>
                <div class="divider">OF</div>
                <div class="join-group">
                    <input type="text" id="room-code-input" placeholder="Kamer Code (bijv. X4K9)" maxlength="4">
                    <button id="join-room-btn" class="secondary-btn">Join Kamer</button>
                </div>
            </div>

            <!-- Active Rooms -->
            <div class="active-rooms-container">
                <h3 class="rooms-title">Actieve Kamers</h3>
                <div id="active-rooms-list" class="rooms-list">
                    <p class="loading-rooms">Laden...</p>
                </div>
            </div>
        </section>

        <!-- Tutorial Section (Separate Panel) -->
        <section class="glass-panel tutorial-panel">
            <details class="tutorial-section" open id="tutorial-details">
                <summary class="tutorial-toggle">
                    <i class="fa-solid fa-circle-info"></i> Hoe werkt het?
                </summary>
                <div class="tutorial-content"
                    onclick="document.getElementById('tutorial-details').open = !document.getElementById('tutorial-details').open">
                    <h3>üö™ Kamer Maken & Deelnemen</h3>
                    <p><strong>Actieve kamers:</strong> Zie direct welke kamers beschikbaar zijn! Vul alleen je naam in
                        en klik op "Meedoen" bij een kamer.</p>
                    <p><strong>Nieuwe kamer:</strong> Maak je eigen kamer met "Nieuwe Kamer". Je krijgt een 4-letterige
                        code die automatisch verschijnt bij anderen.</p>
                    <p><strong>Host:</strong> De maker van de kamer kan de letter draaien, categorie√´n shuffelen en de
                        volgende ronde starten.</p>
                    <p><strong>Verbinding verbroken?</strong> Je naam wordt automatisch onthouden. Herlaad de pagina en
                        klik gewoon opnieuw op "Meedoen" - je komt terug in dezelfde kamer!</p>

                    <h3>üìö Bibliotheek (Per Kamer)</h3>
                    <p>Elke kamer heeft zijn <strong>eigen woordenbibliotheek</strong>. Goedgekeurde antwoorden worden
                        opgeslagen en bij latere rondes automatisch goedgekeurd - maar alleen binnen dezelfde kamer!</p>

                    <h3>üéÆ Spelregels</h3>
                    <p>De host draait een letter en iedereen heeft <strong>30 seconden</strong> om antwoorden in te
                        vullen voor elke categorie die met die letter beginnen.</p>

                    <h3>üèÜ Punten Verdienen</h3>
                    <ul>
                        <li><strong>20 punten</strong> - Jij bent de enige met een geldig antwoord</li>
                        <li><strong>10 punten</strong> - Je hebt een uniek antwoord in een categorie waar anderen ook
                            wat hebben</li>
                        <li><strong>5 punten</strong> - Je antwoord komt (bijna) overeen met dat van iemand anders</li>
                    </ul>

                    <h3>üîç Slimme Woordherkenning</h3>
                    <p>Het spel herkent woorden die op elkaar lijken! Kleine typfouten of meervoud/enkelvoud worden als
                        hetzelfde gezien. Bijvoorbeeld: "Amsterdam" en "Amsterdm" worden als gedeeld antwoord beschouwd.
                    </p>

                    <h3>‚úÖ Stemproces</h3>
                    <p>Na de tijd stemt iedereen op elkaars antwoorden:</p>
                    <ul>
                        <li>Je ziet elk antwoord √©√©n voor √©√©n</li>
                        <li>Stem ‚úÖ (goed) of ‚ùå (fout)</li>
                        <li>Je mag niet op je eigen antwoorden stemmen</li>
                        <li>Meerderheid beslist of het antwoord geldig is</li>
                    </ul>

                    <h3>üìä Ronde Logboek</h3>
                    <p>Aan het eind zie je een volledig overzicht van alle antwoorden, stemmen en punten - zo kan je
                        precies controleren hoe de scores tot stand zijn gekomen!</p>
                </div>
            </details>
        </section>

        <!-- Game Controls (Hidden in Lobby) -->
        <section id="game-controls" class="glass-panel controls-panel hidden">
            <div class="room-info">
                <span>Kamer: <strong id="room-code-display">---</strong></span>
                <span id="player-count">üë§ 1</span>
                <button id="delete-room-game-btn" class="delete-room-game-btn hidden" title="Verwijder kamer">
                    <i class="fa-solid fa-trash"></i> Verwijder Kamer
                </button>
            </div>
            <div class="letter-display-container">
                <div class="letter-circle">
                    <span id="current-letter">?</span>
                </div>
                <!-- Only Host sees this initially, but we handle visibility in JS -->
                <button id="roll-btn" class="primary-btn pulse">DRAAI LETTER</button>
            </div>

            <div class="timer-container">
                <svg class="progress-ring" width="120" height="120">
                    <circle class="progress-ring__circle" stroke="white" stroke-width="4" fill="transparent" r="52"
                        cx="60" cy="60" />
                </svg>
                <div class="timer-text" id="timer-display">60</div>
            </div>
        </section>

        <section id="game-board" class="glass-panel game-board hidden">
            <div class="controls-bar">
                <button id="shuffle-btn" class="sm-btn" title="Nieuwe Categorie√´n"><i class="fa-solid fa-shuffle"></i>
                    Mix Categorie√´n</button>
            </div>

            <!-- Player List -->
            <div id="players-list" class="players-list">
                <!-- Players injected here -->
            </div>

            <div class="categories-grid" id="categories-container">
                <!-- Categories will be injected here via JS -->
            </div>

            <div class="action-bar">
                <button id="stop-btn" class="danger-btn">STOP DE RONDE</button>
            </div>
        </section>

        <!-- Voting Screen -->
        <section id="voting-screen" class="glass-panel voting-panel hidden">
            <h2>Controleer Antwoord</h2>
            <div class="voting-content">
                <p class="voting-context">Heeft <strong id="voting-player-name">---</strong> bij <span
                        id="voting-category">---</span> het volgende antwoord:</p>
                <div class="voting-answer" id="voting-answer-display">---</div>

                <div id="voting-actions" class="voting-actions">
                    <button id="vote-no-btn" class="icon-btn-lg danger"><i class="fa-solid fa-xmark"></i></button>
                    <button id="vote-yes-btn" class="icon-btn-lg success"><i class="fa-solid fa-check"></i></button>
                </div>

                <div id="voting-status">
                    <div class="vote-counts hidden">
                        <div class="vote-column">
                            <span class="vote-pill success"><i class="fa-solid fa-check"></i> <span
                                    id="yes-count">0</span></span>
                            <div id="yes-voters" class="voters-list"></div>
                        </div>
                        <div class="vote-column">
                            <span class="vote-pill danger"><i class="fa-solid fa-xmark"></i> <span
                                    id="no-count">0</span></span>
                            <div id="no-voters" class="voters-list"></div>
                        </div>
                    </div>
                    <p id="voting-status-text">Wachten op stemmen...</p>
                </div>

                <!-- 5s Result Overlay -->
                <div id="voting-result-overlay" class="result-overlay hidden">
                    <div id="voting-verdict-icon" class="verdict-icon"></div>
                    <h3 id="voting-verdict-text">GOEDGEKEURD!</h3>
                </div>
            </div>
        </section>

        <section id="results-board" class="glass-panel results-board hidden">
            <h2>Resultaten</h2>
            <div class="results-table-container">
                <table class="results-table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Naam</th>
                            <th class="text-right">Punten</th>
                        </tr>
                    </thead>
                    <tbody id="results-list">
                        <!-- Injected via JS -->
                    </tbody>
                </table>
            </div>

            <div id="game-history-log" class="history-log hidden">
                <h3 class="log-title">Ronde Logboek</h3>
                <div id="log-entries" class="log-entries">
                    <!-- Injected via JS -->
                </div>
            </div>

            <button id="next-round-btn" class="primary-btn pulse">VOLGENDE RONDE</button>
        </section>
    </main>

    <script type="module" src="script.js?v=30"></script>
</body>

</html>