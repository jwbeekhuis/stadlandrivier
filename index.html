<!DOCTYPE html>
<html lang="nl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, interactive-widget=resizes-content">
    <title>Stad, Land, Rivier</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css?v=105">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
</head>

<body>
    <div class="background-blobs">
        <div class="blob blob-1"></div>
        <div class="blob blob-2"></div>
        <div class="blob blob-3"></div>
    </div>

    <main class="app-container">
        <header class="game-header">
            <h1 data-i18n="title">Stad <span class="highlight">Land</span> Rivier <small
                    style="font-size: 0.4em; opacity: 0.6; font-weight: 300; display: block; margin-top: -5px;" data-i18n="by">by
                    JW</small></h1>
            <div class="header-controls">
                <button id="language-toggle" class="icon-btn" aria-label="Toggle Language" title="EN/NL"><i
                        class="fa-solid fa-language"></i></button>
                <button id="theme-toggle" class="icon-btn" aria-label="Toggle Theme"><i
                        class="fa-solid fa-moon"></i></button>
            </div>
        </header>

        <!-- Lobby Screen -->
        <section id="lobby-screen" class="glass-panel lobby-panel">
            <h2 data-i18n="welcome">Welkom!</h2>
            <div class="input-group">
                <label for="player-name" data-i18n="yourName">Jouw Naam</label>
                <input type="text" id="player-name" placeholder="Typ je naam..." data-i18n-placeholder="namePlaceholder">
            </div>

            <div class="input-group">
                <label for="room-name-input" data-i18n="roomName">Kamer Naam (optioneel)</label>
                <input type="text" id="room-name-input" placeholder="Bijv. Vrienden Groep..." data-i18n-placeholder="roomNamePlaceholder">
            </div>

            <div class="input-group">
                <label for="game-duration-slider"><span data-i18n="gameTime">Speeltijd:</span> <strong><span id="duration-value">60</span> <span data-i18n="seconds">seconden</span></strong></label>
                <input type="range" id="game-duration-slider" min="30" max="300" step="10" value="60" class="duration-slider">
                <div class="slider-labels">
                    <span>30s</span>
                    <span>300s</span>
                </div>
            </div>

            <div class="lobby-actions">
                <button id="create-room-btn" class="primary-btn" data-i18n="newRoom">Nieuwe Kamer</button>
            </div>

            <!-- Active Rooms -->
            <div class="active-rooms-container">
                <h3 class="rooms-title" data-i18n="activeRooms">Actieve Kamers</h3>
                <div id="active-rooms-list" class="rooms-list">
                    <p class="loading-rooms" data-i18n="loading">Laden...</p>
                </div>
            </div>
        </section>

        <!-- Tutorial Section (Separate Panel) -->
        <section class="glass-panel tutorial-panel">
            <details class="tutorial-section" id="tutorial-details">
                <summary class="tutorial-toggle">
                    <span data-i18n="howItWorks">Hoe werkt het?</span>
                </summary>
                <div class="tutorial-content"
                    onclick="document.getElementById('tutorial-details').open = !document.getElementById('tutorial-details').open">
                    <h3>ğŸšª Spel Maken & Deelnemen</h3>
                    <p>ğŸ‘€ <strong>Actieve spellen:</strong> Zie direct welke spellen beschikbaar zijn! Vul alleen je naam in
                        en klik op "Meedoen" bij een spel. Easy peasy! ğŸ¯</p>
                    <p>âœ¨ <strong>Nieuw spel:</strong> Maak je eigen spel met "Nieuw Spel". Je kunt de speeltijd instellen
                        (30-300 seconden) met de slider. Je spel verschijnt automatisch in de lijst bij anderen! ğŸš€</p>
                    <p>ğŸ‘‘ <strong>Host powers:</strong> De maker van het spel kan de letter draaien, categorieÃ«n shuffelen, de
                        volgende ronde starten, spelers verwijderen en het spel verwijderen. Als de host het spel verlaat, neemt de volgende speler automatisch over als nieuwe koning! ğŸ¤´</p>
                    <p>ğŸ‘¢ <strong>Uit spel verwijderd?</strong> Als de host het spel verwijdert of je eruit gooit, word je automatisch teruggestuurd naar het beginscherm. Geen paniek!</p>
                    <p>ğŸ“¶ <strong>Verbinding verbroken?</strong> Geen stress! Je naam wordt automatisch onthouden. Herlaad de pagina en
                        klik gewoon opnieuw op "Meedoen" - je komt terug in hetzelfde spel! Inactieve spelers worden na 2 minuten automatisch verwijderd (3 minuten tijdens stemmen). â°</p>

                    <h3>ğŸ“š Slimme Bibliotheek (Per Spel)</h3>
                    <p>ğŸ§  Elk spel heeft zijn <strong>eigen woordenbibliotheek</strong>. Goedgekeurde antwoorden worden
                        opgeslagen en bij latere rondes automatisch goedgekeurd - maar alleen binnen hetzelfde spel! Zo wordt het spel sneller en eerlijker! ğŸ¯</p>
                    <p>ğŸ˜´ <strong>Spel leeg?</strong> Geen paniek! Als alle spelers inactief worden, wordt je spel niet verwijderd!
                        Het spel gaat in slaapstand en behoudt de volledige woordenbibliotheek. Als originele maker kun je
                        altijd terugkeren en het spel opnieuw openen - alle goedgekeurde woorden blijven veilig bewaard! ğŸ›ŒğŸ’¤</p>

                    <h3>ğŸ® Spelregels</h3>
                    <p>ğŸ² De host draait een letter en BAM! Iedereen heeft de ingestelde tijd (standaard <strong>60 seconden</strong>) om antwoorden in te
                        vullen voor elke categorie die met die letter beginnen. Snelheid en creativiteit = winnen! ğŸ’ª</p>

                    <h3>ğŸ† Punten Verdienen</h3>
                    <ul>
                        <li>ğŸŒŸ <strong>20 punten</strong> - WOW! Jij bent de enige met een geldig antwoord (superstar!)</li>
                        <li>ğŸ’ <strong>10 punten</strong> - Je hebt een uniek antwoord in een categorie waar anderen ook
                            wat hebben (goed gedaan!)</li>
                        <li>ğŸ¤ <strong>5 punten</strong> - Je antwoord komt (bijna) overeen met dat van iemand anders (great minds!)</li>
                    </ul>

                    <h3>ğŸ” Slimme Woordherkenning</h3>
                    <p>ğŸ§  Het spel herkent woorden die op elkaar lijken! Kleine typfouten of meervoud/enkelvoud worden als
                        hetzelfde gezien. Bijvoorbeeld: "Amsterdam" en "Amsterdm" worden als gedeeld antwoord beschouwd. We zijn niet streng hier! ğŸ˜‰
                    </p>

                    <h3>âœ… Stemproces - Tijd om Rechter te Spelen!</h3>
                    <p>âš–ï¸ Na de tijd stemt iedereen op alle antwoorden:</p>
                    <ul>
                        <li>ğŸ“‹ Je ziet alle antwoorden voor Ã©Ã©n categorie tegelijk</li>
                        <li>â° Je hebt <strong>30 seconden</strong> per categorie om op alle antwoorden te stemmen</li>
                        <li>ğŸ†˜ Bij de laatste 5 seconden verschijnt een "+10s Meer Tijd" knop (voor als je twijfelt!)</li>
                        <li>ğŸ˜‡ Als je niet op alle antwoorden stemt binnen de tijd, worden de overgebleven antwoorden automatisch goedgekeurd</li>
                        <li>âš¡ <strong>Als je alle antwoorden beoordeeld hebt, worden je stemmen direct ingediend!</strong> Geen wachten! ğŸš€</li>
                        <li>ğŸ¯ <strong>Als iedereen gestemd heeft, gaat het spel automatisch naar de volgende categorie!</strong> Supersnel!</li>
                        <li>ğŸ‘ğŸ‘ Stem âœ… (goed) of âŒ (fout) voor elk antwoord</li>
                        <li>ğŸ”„ <strong>Je kunt je stem aanpassen</strong> zolang de stemtijd loopt - klik gewoon opnieuw op een knop!</li>
                        <li>ğŸ¤” <strong>Je mag ook op je eigen antwoorden stemmen</strong> - dit maakt het eerlijker en je kunt meediscussiÃ«ren!</li>
                        <li>ğŸ‘¯ Dubbele antwoorden worden automatisch gedetecteerd en gemarkeerd (geen samenspannen!)</li>
                    </ul>

                    <h3>ğŸ“Š Ronde Logboek</h3>
                    <p>ğŸ” Aan het eind zie je een volledig overzicht van alle antwoorden, stemmen en punten - zo kan je
                        precies controleren hoe de scores tot stand zijn gekomen! Transparantie FTW! ğŸ¯</p>
                </div>
            </details>
        </section>

        <!-- Game Controls (Hidden in Lobby) -->
        <section id="game-controls" class="glass-panel controls-panel hidden">
            <div class="room-info">
                <span><span data-i18n="room">Kamer:</span> <strong id="room-code-display">---</strong></span>
                <span id="player-count">ğŸ‘¤ 1</span>
                <button id="leave-room-btn" class="leave-room-btn" data-i18n="leaveRoom" title="Verlaat kamer">
                    <i class="fa-solid fa-arrow-right-from-bracket"></i> Verlaat Kamer
                </button>
                <button id="delete-room-game-btn" class="delete-room-game-btn hidden" data-i18n="deleteRoom" title="Verwijder kamer">
                    <i class="fa-solid fa-trash"></i> Verwijder Kamer
                </button>
            </div>
            <div class="letter-display-container">
                <div class="letter-circle">
                    <span id="current-letter">?</span>
                </div>
                <!-- Only Host sees this initially, but we handle visibility in JS -->
                <button id="roll-btn" class="primary-btn pulse" data-i18n="rollLetter">DRAAI LETTER</button>
                <p id="waiting-for-host-lobby" class="waiting-message hidden" data-i18n="waitingForHostLobby">Wachten tot de host de letter draait...</p>
            </div>
        </section>

        <!-- Sticky Timer (Always on Top) -->
        <div class="sticky-timer-bar" id="sticky-timer-bar">
            <div class="sticky-timer-progress" id="sticky-timer-progress"></div>
            <div class="sticky-timer-text" id="sticky-timer-text">30</div>
            <div class="sticky-timer-letter" id="sticky-timer-letter">?</div>
        </div>

        <section id="game-board" class="glass-panel game-board hidden">
            <div class="controls-bar">
                <button id="shuffle-btn" class="sm-btn" title="Nieuwe CategorieÃ«n" data-i18n="mixCategories"><i class="fa-solid fa-shuffle"></i>
                    Mix CategorieÃ«n</button>
            </div>

            <!-- Player List -->
            <div id="players-list" class="players-list">
                <!-- Players injected here -->
            </div>

            <div class="categories-grid" id="categories-container">
                <!-- Categories will be injected here via JS -->
            </div>

            <div class="action-bar">
                <button id="stop-btn" class="danger-btn" data-i18n="stopRound">STOP DE RONDE</button>
            </div>
        </section>

        <!-- Voting Screen -->
        <section id="voting-screen" class="glass-panel voting-panel hidden">
            <h2 data-i18n="checkAllAnswers">Controleer Alle Antwoorden</h2>
            <div class="voting-category-banner">
                <span class="category-label">Categorie:</span>
                <span id="voting-category-title" class="category-name">---</span>
            </div>

            <div id="vote-timer" class="vote-timer">
                <div class="vote-progress-container">
                    <div class="vote-progress-bar" id="vote-progress-bar"></div>
                    <span class="vote-time-text" id="vote-time-left">30</span>
                </div>
                <button id="more-time-btn" class="more-time-btn hidden" data-i18n="moreTime">+10s Meer Tijd</button>
            </div>

            <div class="voting-content">
                <p class="voting-instructions" data-i18n="voteAllInstructions">Stem op alle antwoorden hieronder. Je kunt je stem aanpassen tot de tijd om is.</p>

                <div id="voting-items-container" class="voting-items-grid">
                    <!-- Voting items will be injected here via JS -->
                </div>

                <div class="voting-submit-container">
                    <p class="vote-progress-text"><span id="voted-count">0</span> / <span id="total-votes-count">0</span> <span data-i18n="voted">gestemd</span></p>
                    <p class="vote-info-text" data-i18n="autoSubmitInfo">Stemmen worden automatisch ingediend wanneer je alles hebt beoordeeld</p>
                </div>
            </div>
        </section>

        <section id="results-board" class="glass-panel results-board hidden">
            <h2 data-i18n="results">Resultaten</h2>
            <div class="results-table-container">
                <table class="results-table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th data-i18n="name">Naam</th>
                            <th class="text-right" data-i18n="points">Punten</th>
                        </tr>
                    </thead>
                    <tbody id="results-list">
                        <!-- Injected via JS -->
                    </tbody>
                </table>
            </div>

            <div id="game-history-log" class="history-log hidden">
                <h3 class="log-title" data-i18n="roundLog">Ronde Logboek</h3>
                <div id="log-entries" class="log-entries">
                    <!-- Injected via JS -->
                </div>
            </div>

            <button id="next-round-btn" class="primary-btn pulse" data-i18n="nextRound">VOLGENDE RONDE</button>
            <p id="waiting-for-host" class="waiting-message hidden" data-i18n="waitingForHost">Wachten tot de host de volgende ronde start...</p>
        </section>
    </main>

    <script type="module" src="script.js?v=105"></script>
</body>

</html>